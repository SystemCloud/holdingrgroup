{"version":3,"file":"ngx-modialog.umd.js","sources":["../../../src/ngx-modialog/src/ngx-modialog.module.ts","../../../src/ngx-modialog/src/models/modal-open-context.ts","../../../src/ngx-modialog/src/models/modal-context.ts","../../../src/ngx-modialog/src/models/overlay-context.ts","../../../src/ngx-modialog/src/providers/outside-event-plugin.ts","../../../src/ngx-modialog/src/providers/modal.ts","../../../src/ngx-modialog/src/providers/dom-modal-renderer.ts","../../../src/ngx-modialog/src/overlay/overlay.service.ts","../../../src/ngx-modialog/src/models/dialog-ref-stack.ts","../../../src/ngx-modialog/src/overlay/overlay.component.ts","../../../src/ngx-modialog/src/components/css-dialog-container.ts","../../../src/ngx-modialog/src/components/css-backdrop.ts","../../../src/ngx-modialog/src/components/base-dynamic-component.ts","../../../src/ngx-modialog/src/overlay/overlay.directives.ts","../../../src/ngx-modialog/src/models/vc-ref-store.ts","../../../src/ngx-modialog/src/models/tokens.ts","../../../src/ngx-modialog/src/models/dialog-ref.ts","../../../src/ngx-modialog/src/models/errors.ts","../../../src/ngx-modialog/src/framework/createComponent.ts","../../../src/ngx-modialog/src/framework/utils.ts","../../../src/ngx-modialog/src/framework/fluent-assign.ts"],"sourcesContent":["import { ANALYZE_FOR_ENTRY_COMPONENTS, NgModule, ModuleWithProviders, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EVENT_MANAGER_PLUGINS } from '@angular/platform-browser';\n\nimport { DOMOutsideEventPlugin, DOMOverlayRenderer } from './providers/index';\nimport { OverlayRenderer } from './models/tokens';\nimport { CSSBackdrop, CSSDialogContainer } from './components/index';\nimport {\n  Overlay,\n  ModalOverlay,\n  OverlayDialogBoundary,\n  OverlayTarget\n} from './overlay/index';\n\n@NgModule({\n  declarations: [\n    ModalOverlay,\n    CSSBackdrop,\n    CSSDialogContainer,\n    OverlayDialogBoundary,\n    OverlayTarget\n  ],\n  imports: [ CommonModule ],\n  exports: [\n    CSSBackdrop,\n    CSSDialogContainer,\n    OverlayDialogBoundary,\n    OverlayTarget\n  ],\n  providers: [\n    Overlay\n  ],\n  entryComponents: [\n    ModalOverlay,\n    CSSBackdrop,\n    CSSDialogContainer\n  ]\n})\nexport class ModalModule {\n\n  /**\n   * Returns a ModalModule pre-loaded with a list of dynamically inserted components.\n   * Since dynamic components are not analysed by the angular compiler they must register manually\n   * using entryComponents, this is an easy way to do it.\n   * @param entryComponents A list of dynamically inserted components (dialog's).\n   */\n  static withComponents(entryComponents: Array<Type<any> | any[]>): ModuleWithProviders {\n    return {\n      ngModule: ModalModule,\n      providers: [\n        {provide: ANALYZE_FOR_ENTRY_COMPONENTS, useValue: entryComponents, multi: true}\n      ]\n    }\n  }\n\n  /**\n   * Returns a NgModule for use in the root Module.\n   * @param entryComponents A list of dynamically inserted components (dialog's).\n   */\n  static forRoot(entryComponents?: Array<Type<any> | any[]>): ModuleWithProviders {\n    return {\n      ngModule: ModalModule,\n      providers: [\n        {provide: OverlayRenderer, useClass: DOMOverlayRenderer},\n        {provide: EVENT_MANAGER_PLUGINS, useClass: DOMOutsideEventPlugin, multi: true},\n        {provide: ANALYZE_FOR_ENTRY_COMPONENTS, useValue: entryComponents || [], multi: true}\n      ]\n    };\n  }\n}\n","import { ResolvedReflectiveProvider } from '@angular/core';\n\nimport { FluentAssignMethod } from '../framework/fluent-assign';\nimport { ModalComponent, OverlayConfig, WideVCRef } from './tokens';\nimport { Modal } from '../providers/index';\nimport { DialogRef } from './dialog-ref';\nimport { ModalContext, ModalContextBuilder } from './modal-context';\nimport { ModalControllingContextBuilder } from './overlay-context';\n\nimport { arrayUnion } from '../framework/utils';\n\nconst DEFAULT_SETTERS = [\n  'component'\n];\n\nexport class ModalOpenContext extends ModalContext {\n  component: any;\n  modal: Modal;\n}\n\n/**\n * A Modal Context that knows about the modal service, and so can open a modal window on demand.\n * Use the fluent API to configure the preset and then invoke the 'open' method to open a modal\n * based on the context.\n */\nexport abstract class ModalOpenContextBuilder<T extends ModalOpenContext>\n                  extends ModalContextBuilder<T> implements ModalControllingContextBuilder<T> {\n\n  /**\n   * A Class for the footer container.\n   * Default: modal-footer\n   */\n  component: FluentAssignMethod<ModalComponent<T>, this>;\n\n  constructor(defaultValues: T = undefined,\n              initialSetters: string[] = undefined,\n              baseType: new () => T = undefined) {\n    super(\n      defaultValues || <any>{},\n      arrayUnion<string>(DEFAULT_SETTERS, initialSetters || []),\n      baseType\n    );\n  }\n\n  /**\n   * Hook to alter config and return bindings.\n   * @param config\n   */\n  protected $$beforeOpen(config: T): void { }\n\n  /**\n   * Open a modal window based on the configuration of this config instance.\n   * @param viewContainer If set opens the modal inside the supplied viewContainer\n   */\n  open(viewContainer?: WideVCRef): DialogRef<T> {\n    let context: T = this.toJSON();\n\n    if (!(context.modal instanceof Modal)) {\n      return <any>Promise.reject(new Error('Configuration Error: modal service not set.'));\n    }\n\n    this.$$beforeOpen(context);\n\n    let overlayConfig: OverlayConfig = {\n      context: context,\n      viewContainer: viewContainer\n    };\n\n    return context.modal.open(context.component, overlayConfig);\n  }\n}\n","import { FluentAssignMethod } from './../framework/fluent-assign';\nimport { extend, arrayUnion } from './../framework/utils';\nimport { OverlayContext, OverlayContextBuilder } from './overlay-context';\n\nexport const DEFAULT_VALUES = {};\n\nconst DEFAULT_SETTERS = [\n    'message'\n];\n\nexport class ModalContext extends OverlayContext {\n    /**\n     * The core message to display.\n     * A modal might have an extended message (e.g: HTML message) or other fields (e.g: title) but\n     * all models, at core, convey a message thus message is common to all modals.\n     */\n    message: string;\n}\n\n/**\n * A core context builder for a modal window instance, used to define the context upon\n * a modal choose it's behaviour.\n */\nexport class ModalContextBuilder<T extends ModalContext> extends OverlayContextBuilder<T> {\n    /**\n     * The core message to display.\n     * A modal might have an extended message (e.g: HTML message) or other fields (e.g: title) but\n     * all models, at core, convey a message thus message is common to all modals.\n     */\n    message: FluentAssignMethod<string, this>;\n\n    constructor(\n        defaultValues: T | T[] = undefined,\n        initialSetters: string[] = undefined,\n        baseType: new () => T = undefined\n    ) {\n        super(\n            extend<any>(DEFAULT_VALUES, defaultValues || {}),\n            arrayUnion<string>(DEFAULT_SETTERS, initialSetters || []),\n            baseType\n        );\n    }\n}\n","import { FluentAssign, FluentAssignMethod } from './../framework/fluent-assign';\nimport { extend, arrayUnion } from './../framework/utils';\nimport { DialogRef } from './dialog-ref';\nimport { WideVCRef, OverlayConfig } from './tokens';\n\nexport const DEFAULT_VALUES = {\n  inElement: false,\n  isBlocking: true,\n  keyboard: [27],\n  supportsKey: function supportsKey(keyCode: number): boolean {\n    return (<Array<number>>this.keyboard).indexOf(keyCode) > -1;\n  }\n};\n\nconst DEFAULT_SETTERS = [\n  'inElement',\n  'isBlocking',\n  'keyboard'\n];\n\nexport class OverlayContext {\n  /**\n   * Describes if the modal is rendered within the container element.\n   * The container element is the ViewContainerRef supplied.\n   * Defaults to false.\n   */\n  inElement: boolean;\n\n  /**\n   * Describes if the modal is blocking modal.\n   * A Blocking modal is not closable by clicking outside of the modal window.\n   * Defaults to false.\n   */\n  isBlocking: boolean;\n\n  /**\n   * Keyboard value/s that close the modal.\n   * Accepts either a single numeric value or an array of numeric values.\n   * A modal closed by a keyboard stroke will result in a 'reject' notification from the promise.\n   * Defaults to 27, set `null` implicitly to disable.\n   */\n  keyboard: Array<number> | number;\n\n  normalize(): void {\n    if (this.isBlocking !== false)\n      this.isBlocking = true;\n\n    if (this.keyboard === null) {\n      this.keyboard = [];\n    } else if (typeof this.keyboard === 'number') {\n      this.keyboard = [<number>this.keyboard];\n    } else if (!Array.isArray(<Array<number>>this.keyboard)) {\n      this.keyboard = DEFAULT_VALUES.keyboard;\n    }\n  }\n}\n\n/**\n * A core context builder for a modal window instance, used to define the context upon\n * a modal choose it's behaviour.\n */\nexport class OverlayContextBuilder<T extends OverlayContext> extends FluentAssign<T> {\n  /**\n   * Describes if the modal is rendered within the container element.\n   * The container element is the ViewContainerRef supplied.\n   * Defaults to false.\n   */\n  inElement: FluentAssignMethod<boolean, this>;\n\n  /**\n   * Describes if the modal is blocking modal.\n   * A Blocking modal is not closable by clicking outside of the modal window.\n   * Defaults to false.\n   */\n  isBlocking: FluentAssignMethod<boolean, this>;\n\n  /**\n   * Keyboard value/s that close the modal.\n   * Accepts either a single numeric value or an array of numeric values.\n   * A modal closed by a keyboard stroke will result in a 'reject' notification from the promise.\n   * Defaults to 27, set `null` implicitly to disable.\n   */\n  keyboard: FluentAssignMethod<Array<number> | number, this>;\n\n\n  constructor(defaultValues: T | T[] = undefined,\n              initialSetters: string[] = undefined,\n              baseType: new () => T = undefined) {\n    super(\n      extend<any>(DEFAULT_VALUES, defaultValues || {}),\n      arrayUnion<string>(DEFAULT_SETTERS, initialSetters || []),\n      baseType || <any>OverlayContext // https://github.com/Microsoft/TypeScript/issues/7234\n    );\n  }\n\n  /**\n   * Returns an new OverlayConfig with a context property representing the data in this builder.\n   * @param base A base configuration that the result will extend\n   */\n  toOverlayConfig(base?: OverlayConfig): OverlayConfig {\n    return extend(base || {}, {\n      context: this.toJSON()\n    });\n  }\n}\n\nexport interface ModalControllingContextBuilder<T> {\n  open(viewContainer?: WideVCRef): DialogRef<T>;\n}\n\n/**\n * A helper to create an `OverlayConfig` on the fly.\n * Since `OverlayConfig` requires context it means a builder is needed, this process had some boilerplate.\n * When a quick, on the fly overlay config is needed use this helper to avoid that boilerplate.\n *\n * A builder is used as an API to allow setting the context and providing some operations around the modal.\n * When a developers knows the context before hand we can skip this step, this is what this factory is for.\n *\n * @param context The context for the modal\n * @param baseContextType Optional. The type/class of the context. This is the class used to init a new instance of the context\n * @param baseConfig A base configuration that the result will extend\n */\nexport function overlayConfigFactory<T>(context: T, baseContextType?: any, baseConfig?: OverlayConfig): OverlayConfig {\n  return new OverlayContextBuilder<T & OverlayContext>(<any>context, undefined, baseContextType).toOverlayConfig(baseConfig);\n}\n","// heavily inspired by:\n// http://www.bennadel.com/blog/3025-creating-custom-dom-and-host-event-bindings-in-angular-2-beta-6.htm\n\nimport { Injectable } from '@angular/core';\nimport { EventManager } from '@angular/platform-browser';\nimport { noop } from '../framework/utils';\n\n// TODO: use DI factory for this.\n// TODO: consolidate dup code\nconst isDoc: boolean = !(typeof document === 'undefined' || !document);\n\nconst eventMap = {\n    clickOutside: 'click',\n    mousedownOutside: 'mousedown',\n    mouseupOutside: 'mouseup',\n    mousemoveOutside: 'mousemove'\n};\n\n/**\n * An event handler factory for event handlers that bubble the event to a given handler\n * if the event target is not an ancestor of the given element.\n * @param element\n * @param handler\n */\nfunction bubbleNonAncestorHandlerFactory(element: HTMLElement, handler: (event) => void) {\n    return (event) => {\n        let current = event.target;\n        do {\n            if (current === element) {\n                return;\n            }\n        } while (current.parentNode && ( current = current.parentNode ));\n\n        handler(event);\n    };\n}\n\n@Injectable()\nexport class DOMOutsideEventPlugin { // extends EventManagerPlugin\n    manager: EventManager;\n\n    constructor() {\n    if (!isDoc || typeof document.addEventListener !== 'function') {\n        this.addEventListener = noop as any;\n    }\n    }\n\n    supports(eventName: string): boolean {\n        return eventMap.hasOwnProperty(eventName);\n    }\n\n    addEventListener(element: HTMLElement, eventName: string, handler: Function): Function {\n        const zone = this.manager.getZone();\n\n        // A Factory that registers the event on the document, instead of the element.\n        // the handler is created at runtime, and it acts as a propagation/bubble predicate, it will\n        // bubble up the event (i.e: execute our original event handler) only if the event targer\n        // is an ancestor of our element.\n        // The event is fired inside the angular zone so change detection can kick into action.\n        const onceOnOutside = () => {\n            const listener =\n              bubbleNonAncestorHandlerFactory(element, evt => zone.runGuarded(() => handler(evt)));\n\n            // mimic BrowserDomAdapter.onAndCancel\n            document.addEventListener(eventMap[eventName], listener, false);\n            return () => document.removeEventListener(eventMap[eventName], listener, false);\n        };\n\n        // we run the event registration for the document in a different zone, this will make sure\n        // change detection is off.\n        // It turns out that if a component that use DOMOutsideEventPlugin is built from a click\n        // event, we might get here before the event reached the document, causing a quick false\n        // positive handling (when stopPropagation() was'nt invoked). To workaround this we wait\n        // for the next vm turn and register.\n        // Event registration returns a dispose function for that event, angular use it to clean\n        // up after component get's destroyed. Since we need to return a dispose function\n        // synchronously we have to put a wrapper for it since we will get it asynchronously,\n        // i.e: after we need to return it.\n        //\n        return zone.runOutsideAngular(() => {\n            let fn: Function;\n            setTimeout(() => fn = onceOnOutside(), 0);\n            return () => {\n                if (fn) fn();\n            };\n        });\n    }\n\n}\n","import { ComponentRef } from '@angular/core';\n\nimport { Overlay } from '../overlay/index';\nimport { Class } from '../framework/utils';\nimport { OverlayConfig, ContainerContent } from '../models/tokens';\nimport { DialogRef } from '../models/dialog-ref';\nimport { ModalControllingContextBuilder } from '../models/overlay-context';\n\nexport function unsupportedDropInError(dropInName: string): Error {\n  return new Error(`Unsupported Drop-In ${dropInName}`);\n}\n\nexport abstract class Modal {\n  constructor(public overlay: Overlay) { }\n\n\n  alert(): ModalControllingContextBuilder<any> {\n    throw unsupportedDropInError('alert');\n  }\n\n  prompt(): ModalControllingContextBuilder<any> {\n    throw unsupportedDropInError('prompt');\n  }\n\n  confirm(): ModalControllingContextBuilder<any> {\n    throw unsupportedDropInError('confirm');\n  }\n\n  /**\n   * Opens a modal window inside an existing component.\n   * @param content The content to display, either string, template ref or a component.\n   * @param config Additional settings.\n   */\n  open(content: ContainerContent, config?: OverlayConfig): DialogRef<any> {\n    config = config || {} as any;\n    let dialogs = this.overlay.open(config, this.constructor);\n\n    if (dialogs.length > 1) {\n      console.warn(`Attempt to open more then 1 overlay detected.\n      Multiple modal copies are not supported at the moment, \n      only the first viewContainer will display.`);\n    }\n    // TODO:  Currently supporting 1 view container, hence working on dialogs[0].\n    //        upgrade to multiple containers.\n    return this.create(dialogs[0], content)\n  }\n\n  /**\n   * A Hook that enables derived classes to add content to the overlay.\n   * @param dialogRef\n   * @param type\n   */\n  protected abstract create(dialogRef: DialogRef<any>, type: ContainerContent): DialogRef<any>;\n\n\n  protected createBackdrop<T>(dialogRef: DialogRef<any>, BackdropComponent: Class<T>): ComponentRef<T> {\n    return dialogRef.overlayRef.instance.addComponent<T>(BackdropComponent);\n  }\n\n  protected createContainer<T>(\n    dialogRef: DialogRef<any>,\n    ContainerComponent: Class<T>,\n    content: ContainerContent): ComponentRef<T> {\n\n    let nodes: any[] = dialogRef.overlayRef.instance.getProjectables(content);\n    return dialogRef.overlayRef.instance.addComponent<T>(ContainerComponent, nodes);\n  }\n\n}\n","import {\n  ApplicationRef,\n  ViewContainerRef,\n  ComponentRef,\n  Injector,\n  Injectable\n} from '@angular/core';\n\nimport { createComponent } from '../framework/createComponent';\nimport { DialogRef } from '../models/dialog-ref';\nimport { OverlayRenderer } from '../models/tokens';\nimport { ModalOverlay } from '../overlay/index';\n\n@Injectable()\nexport class DOMOverlayRenderer implements OverlayRenderer {\n\n  private isDoc: boolean = !(typeof document === 'undefined' || !document);\n\n  constructor(private appRef: ApplicationRef, private injector: Injector) { }\n\n  render(dialog: DialogRef<any>, vcRef: ViewContainerRef, injector?: Injector): ComponentRef<ModalOverlay> {\n    if (!injector) {\n      injector = this.injector;\n    }\n\n    const cmpRef = createComponent({\n      component: ModalOverlay,\n      vcRef,\n      injector: Injector.create([\n        { provide: DialogRef, useValue: dialog }\n      ], injector)\n    });\n\n    if (!vcRef) {\n      this.appRef.attachView(cmpRef.hostView);\n\n      // TODO: doesn't look like this is needed, explore. leaving now to be on the safe side.\n      dialog.onDestroy.subscribe( () => this.appRef.detachView(cmpRef.hostView) );\n    }\n\n    if (vcRef && dialog.inElement) {\n      vcRef.element.nativeElement.appendChild(cmpRef.location.nativeElement);\n    } else if (this.isDoc) {\n      document.body.appendChild(cmpRef.location.nativeElement);\n    }\n\n    return cmpRef;\n  }\n}\n\n","import { ViewContainerRef, Injectable, Injector } from '@angular/core';\n\nimport { OverlayRenderer, OverlayConfig } from '../models/tokens';\nimport { DialogRefStack } from '../models/dialog-ref-stack';\nimport { vcRefStore } from '../models/vc-ref-store';\nimport { DialogRef } from '../models/dialog-ref';\nimport { OverlayContext } from '../models/overlay-context';\n\nconst _stack = new DialogRefStack<any>();\n\n@Injectable()\nexport class Overlay {\n  get stackLength(): number {\n    return _stack.length;\n  }\n\n  constructor(private _modalRenderer: OverlayRenderer, protected injector: Injector) {\n  }\n\n  /**\n   * Check if a given DialogRef is the top most ref in the stack.\n   * TODO: distinguish between body modal vs in element modal.\n   * @param dialogRef\n   */\n  isTopMost(dialogRef: DialogRef<any>): boolean {\n    return _stack.indexOf(dialogRef) === _stack.length - 1;\n  }\n\n  stackPosition(dialogRef: DialogRef<any>) {\n    return _stack.indexOf(dialogRef);\n  }\n\n  groupStackLength(dialogRef: DialogRef<any>): number {\n    return _stack.groupLength(_stack.groupOf(dialogRef));\n  }\n\n  closeAll(result: any = null): void {\n      _stack.closeAll(result);\n  }\n\n  /**\n   * Creates an overlay and returns a dialog ref.\n   * @param config instructions how to create the overlay\n   * @param group A token to associate the new overlay with, used for reference (stacks usually)\n   */\n  open<T extends OverlayContext>(config: OverlayConfig, group?: any): DialogRef<T>[] {\n    let viewContainer = config.viewContainer,\n        containers: Array<ViewContainerRef> = [];\n\n    if (typeof viewContainer === 'string') {\n      containers = vcRefStore.getVCRef(viewContainer as string);\n    } else if (Array.isArray(viewContainer)) {\n      containers = viewContainer as any;\n    } else if (viewContainer) {\n      containers = [viewContainer] as any;\n    } else {\n      containers = [null];\n    }\n\n    return containers\n      .map( vc => this.createOverlay(config.renderer || this._modalRenderer, vc, config, group));\n  }\n\n  private createOverlay(renderer: OverlayRenderer,\n                        vcRef: ViewContainerRef,\n                        config: OverlayConfig,\n                        group: any): DialogRef<any> {\n\n    if (config.context) {\n      config.context.normalize();\n    }\n\n    if (!config.injector) {\n      config.injector = this.injector;\n    }\n\n    let dialog = new DialogRef<any>(this, config.context || {});\n    dialog.inElement = config.context && !!config.context.inElement;\n\n    let cmpRef = renderer.render(dialog, vcRef, config.injector);\n\n    Object.defineProperty(dialog, 'overlayRef', {value: cmpRef});\n    _stack.pushManaged(dialog, group);\n\n    return dialog;\n  }\n}\n","import { DialogRef } from './dialog-ref';\n\nconst BASKET_GROUP = {};\n\n/**\n * A dumb stack implementation over an array.\n */\nexport class DialogRefStack<T> {\n  private _stack: DialogRef<T>[];\n  private _stackMap: Map<DialogRef<T>, any>;\n\n  get length(): number {\n    return this._stack.length;\n  }\n\n  constructor() {\n    this._stack = [];\n    this._stackMap = new Map<DialogRef<T>, any>();\n  }\n\n  closeAll(result: any = null): void {\n    for (let i=0, len=this._stack.length; i<len; i++) {\n      this._stack.pop().close(result);\n    }\n  }\n\n  push(dialogRef: DialogRef<T>, group?: any): void {\n    if (this._stack.indexOf(dialogRef) === -1) {\n      this._stack.push(dialogRef);\n      this._stackMap.set(dialogRef, group || BASKET_GROUP);\n    }\n  }\n\n  /**\n   * Push a DialogRef into the stack and manage it so when it's done\n   * it will automatically kick itself out of the stack.\n   * @param dialogRef\n   */\n  pushManaged(dialogRef: DialogRef<T>, group?: any): void {\n    this.push(dialogRef, group);\n    dialogRef.onDestroy.subscribe(() => this.remove(dialogRef));\n  }\n\n  pop(): DialogRef<T> {\n    const dialogRef = this._stack.pop();\n    this._stackMap.delete(dialogRef);\n    return dialogRef;\n  }\n\n  /**\n   * Remove a DialogRef from the stack.\n   * @param dialogRef\n   */\n  remove(dialogRef: DialogRef<T>): void {\n    let idx = this.indexOf(dialogRef);\n    if (idx > -1) {\n      this._stack.splice(idx, 1);\n      this._stackMap.delete(dialogRef);\n    }\n  }\n\n  index(index: number): DialogRef<T> {\n    return this._stack[index];\n  }\n\n  indexOf(dialogRef: DialogRef<T>): number {\n     return this._stack.indexOf(dialogRef);\n  }\n\n  groupOf(dialogRef: DialogRef<T>): any {\n    return this._stackMap.get(dialogRef);\n  }\n\n  groupBy(group: any): DialogRef<T>[] {\n    let arr = [];\n    if (group) {\n      this._stackMap.forEach( (value, key) => {\n        if (value === group) {\n          arr.push(key);\n        }\n      });\n    }\n    return arr;\n  }\n\n  groupLength(group: any): number {\n    let count = 0;\n    if (group) {\n      this._stackMap.forEach( (value) => {\n        if (value === group) {\n          count++;\n        }\n      });\n    }\n    return count;\n  }\n}\n","declare const clearTimeout: any;\n\nimport {\n  Component,\n  ComponentRef,\n  ElementRef,\n  EmbeddedViewRef,\n  Injector,\n  ViewChild,\n  ViewContainerRef,\n  ViewEncapsulation,\n  Renderer2,\n  TemplateRef\n} from '@angular/core';\n\nimport { PromiseCompleter, supportsKey } from '../framework/utils';\nimport { DialogRef } from '../models/dialog-ref';\nimport { ContainerContent } from '../models/tokens';\nimport { BaseDynamicComponent } from '../components/index';\n\n// TODO: use DI factory for this.\n// TODO: consolidate dup code\nconst isDoc: boolean = !(typeof document === 'undefined' || !document);\n\nexport interface EmbedComponentConfig {\n  component: any;\n  projectableNodes?: any[][];\n}\n\n/**\n * Represents the modal overlay.\n */\n@Component({\n  selector: 'modal-overlay',\n  host: {\n    '(body:keydown)': 'documentKeypress($event)'\n  },\n  encapsulation: ViewEncapsulation.None,\n  templateUrl: './overlay.component.html'\n})\nexport class ModalOverlay extends BaseDynamicComponent {\n  private beforeDestroyHandlers: Array<() => Promise<void>>;\n\n  @ViewChild('container', {read: ElementRef}) public container: ElementRef;\n  @ViewChild('innerView', {read: ViewContainerRef}) public innerVcr: ViewContainerRef;\n  @ViewChild('template') public template: TemplateRef<any>;\n\n  constructor(private dialogRef: DialogRef<any>,\n              private vcr: ViewContainerRef,\n              el: ElementRef,\n              renderer: Renderer2) {\n    super(el, renderer);\n    this.activateAnimationListener();\n  }\n\n  /**\n   * @internal\n   */\n  getProjectables<T> (content: ContainerContent): any[][] {\n\n    let nodes: any[];\n    if (typeof content === 'string') {\n      nodes = [ [this.renderer.createText(`${content}`)] ];\n    } else if (content instanceof TemplateRef) {\n      nodes = [ this.vcr.createEmbeddedView(content, { $implicit: this.dialogRef.context, dialogRef: this.dialogRef }).rootNodes ];\n    } else {\n      nodes = [ this.embedComponent({ component: content }).rootNodes ];\n    }\n\n    return nodes;\n  }\n\n  embedComponent(config: EmbedComponentConfig): EmbeddedViewRef<EmbedComponentConfig> {\n    const ctx: EmbedComponentConfig & { injector: Injector } = <any>config;\n\n    return this.vcr.createEmbeddedView(this.template, <any> {\n      $implicit: ctx\n    });\n  }\n\n  addComponent<T>(type: any, projectableNodes: any[][] = []): ComponentRef<T> {\n    return super._addComponent<T>({\n      component: type,\n      vcRef: this.innerVcr,\n      projectableNodes\n    });\n  }\n\n  fullscreen(): void {\n    const style = {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      bottom: 0,\n      right: 0,\n      'z-index': 1500\n    };\n    Object.keys(style).forEach( k => this.setStyle(k, style[k]) );\n  }\n\n  insideElement(): void {\n    const style = {\n      position: 'absolute',\n      overflow: 'hidden',\n      width: '100%',\n      height: '100%',\n      top: 0,\n      left: 0,\n      bottom: 0,\n      right: 0\n    };\n    Object.keys(style).forEach( k => this.setStyle(k, style[k]) );\n  }\n\n  /**\n   * Set a specific inline style for the container of the whole dialog component\n   * The dialog component root element is the host of this component, it contains only 1 direct\n   * child which is the container.\n   *\n   * Structure:\n   *\n   * ```html\n   * <modal-overlay>\n   *   <div>\n   *     <!-- BACKDROP ELEMENT -->\n   *     <!-- DIALOG CONTAINER ELEMENT -->\n   *   </div>\n   * </modal-overlay>\n   * ```\n   *\n   * @param prop The style key\n   * @param value The value, undefined to remove\n   */\n  setContainerStyle(prop: string, value: string): this {\n    this.renderer.setStyle(this.container.nativeElement, prop, value);\n    return this;\n  }\n\n  /**\n   * Define an element that click inside it will not trigger modal close.\n   * Since events bubble, clicking on a dialog will bubble up to the overlay, a plugin\n   * must define an element that represent the dialog, the overlay will make sure no to close when\n   * it was clicked.\n   * @param element\n   */\n  setClickBoundary(element: Element): void {\n    let target: Element;\n    const elListener = event => target = event.target as any;\n    const docListener = event => {\n      if (this.dialogRef.context.isBlocking || !this.dialogRef.overlay.isTopMost(this.dialogRef) ) {\n        return;\n      }\n\n      let current: any = event.target;\n\n      // on click, this will hit.\n      if (current === target) return;\n\n      // on mouse down -> drag -> release the current might not be 'target', it might be\n      // a sibling or a child (i.e: not part of the tree-up direction). It might also be a release\n      // outside the dialog... so we compare to the boundary element\n      do {\n        if (current === element) {\n          return;\n        }\n      } while (current.parentNode && ( current = current.parentNode ));\n      this.dialogRef.dismiss();\n    };\n\n    if (isDoc) {\n      this.dialogRef.onDestroy.subscribe(() => {\n        element.removeEventListener('click', elListener, false);\n        element.removeEventListener('touchstart', elListener, false);\n        document.removeEventListener('click', docListener, false);\n        document.removeEventListener('touchend', docListener, false);\n      });\n\n\n      setTimeout(() => {\n        element.addEventListener('mousedown', elListener, false);\n        element.addEventListener('touchstart', docListener, false);\n        document.addEventListener('click', docListener, false);\n        document.addEventListener('touchend', docListener, false);\n      });\n    }\n  }\n\n  /**\n   * Temp workaround for animation where destruction of the top level component does not\n   * trigger child animations. Solution should be found either in animation module or in design\n   * of the modal component tree.\n   */\n  canDestroy(): Promise<void> {\n    const completer = new PromiseCompleter<void>();\n\n    if (!Array.isArray(this.beforeDestroyHandlers)) {\n      completer.resolve();\n    } else {\n\n      // run destroy notification but protect against halt.\n      let id = setTimeout(() => {\n        id = null;\n        completer.reject();\n      }, 1000);\n\n      const resolve = () => {\n        if (id === null) return;\n\n        clearTimeout(id);\n        completer.resolve();\n      };\n\n      Promise.all(this.beforeDestroyHandlers.map( fn => fn() ))\n        .then(resolve)\n        .catch(resolve);\n\n    }\n\n    return completer.promise;\n  }\n\n  /**\n   * A handler running before destruction of the overlay\n   * use to delay destruction due to animation.\n   * This is part of the workaround for animation, see canDestroy.\n   *\n   * NOTE: There is no guarantee that the listeners will fire, use dialog.onDestory for that.\n   * @param fn\n   */\n  beforeDestroy(fn: () => Promise<void>) {\n    if (!this.beforeDestroyHandlers) {\n      this.beforeDestroyHandlers = [];\n    }\n    this.beforeDestroyHandlers.push(fn);\n  }\n\n  documentKeypress(event: KeyboardEvent) {\n    // check that this modal is the last in the stack.\n    if (!this.dialogRef.overlay.isTopMost(this.dialogRef)) return;\n\n\n    if (supportsKey(event.keyCode, <any>this.dialogRef.context.keyboard)) {\n      this.dialogRef.dismiss();\n    }\n  }\n\n  ngOnDestroy(): void {\n    super.ngOnDestroy();\n    if (this.dialogRef.destroyed !== true) {\n      // if we're here the overlay is destroyed by an external event that is not user invoked.\n      // i.e: The user did no call dismiss or close and dialogRef.destroy() did not invoke.\n      // this will happen when routing or killing an element containing a blocked overlay (ngIf)\n      // we bail out, i.e gracefully shutting down.\n      this.dialogRef.bailOut();\n    }\n  }\n}\n","import {\n  Component,\n  ViewEncapsulation,\n  ElementRef,\n  Renderer2\n} from '@angular/core';\n\nimport { BaseDynamicComponent } from './base-dynamic-component';\nimport { DialogRef } from '../models/dialog-ref';\n\n/**\n * A component that acts as a top level container for an open modal window.\n */\n@Component({\n  selector: 'css-dialog-container',\n  host: {\n    'tabindex': '-1',\n    'role': 'dialog'\n  },\n  encapsulation: ViewEncapsulation.None,\n  template: `<ng-content></ng-content>`\n})\nexport class CSSDialogContainer extends BaseDynamicComponent {\n\n  constructor(public dialog: DialogRef<any>, el: ElementRef, renderer: Renderer2) {\n    super(el, renderer);\n    this.activateAnimationListener();\n  }\n\n}\n","import {\n  Component,\n  ElementRef,\n  ViewEncapsulation,\n  Renderer2\n} from '@angular/core';\n\nimport { BaseDynamicComponent } from './base-dynamic-component';\n\n/**\n * Represents the modal backdrop shaped by CSS.\n */\n@Component({\n  selector: 'css-backdrop',\n  host: {\n    '[attr.class]': 'cssClass',\n    '[attr.style]': 'styleStr'\n  },\n  encapsulation: ViewEncapsulation.None,\n  template: ``\n})\nexport class CSSBackdrop extends BaseDynamicComponent {\n  public cssClass: string;\n  public styleStr: string;\n\n  constructor(el: ElementRef, renderer: Renderer2) {\n    super(el, renderer);\n    this.activateAnimationListener();\n\n    const style = {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%'\n    };\n    Object.keys(style).forEach( k => this.setStyle(k, style[k]) );\n  }\n}\n","import {\n  ComponentRef,\n  ElementRef,\n  OnDestroy,\n  Renderer2\n} from '@angular/core';\n\nimport { Observable } from 'rxjs/Observable';\nimport { Subject } from 'rxjs/Subject';\nimport { filter } from 'rxjs/operator/filter';\n\nimport { createComponent, CreateComponentArgs } from '../framework/createComponent';\n\nconst BROWSER_PREFIX = ['webkit', 'moz', 'MS', 'o', ''];\n\nfunction register(eventName, element, cb) {\n  BROWSER_PREFIX.forEach( p => {\n    element.addEventListener(p ? p + eventName : eventName.toLowerCase(), cb, false);\n  });\n}\n\n/**\n * A base class for supporting dynamic components.\n * There are 3 main support areas:\n * 1 - Easy wrapper for dynamic styling via CSS classes and inline styles.\n * 2 - Easy wrapper for interception of transition/animation end events.\n * 3 - Easy wrapper for component creation and injection.\n *\n * Dynamic css is done via direct element manipulation (via renderer), it does not use change detection\n * or binding. This is to allow better control over animation.\n *\n * Animation support is limited, only transition/keyframes END even are notified.\n * The animation support is needed since currently the angular animation module is limited as well and\n * does not support CSS animation that are not pre-parsed and are not in the styles metadata of a component.\n *\n * Capabilities: Add/Remove styls, Add/Remove classes, listen to animation/transition end event,\n * add components\n */\nexport class BaseDynamicComponent implements OnDestroy {\n  animationEnd$: Observable<TransitionEvent | AnimationEvent>;\n\n  protected animationEnd: Subject<TransitionEvent | AnimationEvent>;\n\n  constructor(protected el: ElementRef,\n              protected renderer: Renderer2) {}\n\n  activateAnimationListener() {\n    if (this.animationEnd) return;\n    this.animationEnd = new Subject<TransitionEvent | AnimationEvent>();\n    this.animationEnd$ = this.animationEnd.asObservable();\n    register('TransitionEnd', this.el.nativeElement, (e: TransitionEvent) => this.onEnd(e));\n    register('AnimationEnd', this.el.nativeElement, (e: AnimationEvent) => this.onEnd(e));\n  }\n\n  /**\n   * Set a specific inline style on the overlay host element.\n   * @param prop The style key\n   * @param value The value, undefined to remove\n   */\n  setStyle(prop: string, value: string): this {\n    this.renderer.setStyle(this.el.nativeElement, prop, value);\n    return this;\n  }\n\n  forceReflow() {\n    this.el.nativeElement.offsetWidth;\n  }\n\n  addClass(css: string, forceReflow: boolean = false): void {\n    css.split(' ')\n      .forEach( c => this.renderer.addClass(this.el.nativeElement, c) );\n    if (forceReflow) this.forceReflow();\n  }\n\n  removeClass(css: string, forceReflow: boolean = false): void {\n    css.split(' ')\n      .forEach( c => this.renderer.removeClass(this.el.nativeElement, c) );\n    if (forceReflow) this.forceReflow();\n  }\n\n  ngOnDestroy(): void {\n    if (this.animationEnd && !this.animationEnd.closed) {\n      this.animationEnd.complete();\n    }\n  }\n\n  myAnimationEnd$(): Observable<AnimationEvent | TransitionEvent> {\n    return filter.call(this.animationEnd$, e => e.target === this.el.nativeElement);\n  }\n\n  /**\n   * Add a component, supply a view container ref.\n   * Note: The components vcRef will result in a sibling.\n   */\n  protected _addComponent<T>(instructions: CreateComponentArgs): ComponentRef<T> {\n    const cmpRef = createComponent(instructions);\n    cmpRef.changeDetectorRef.detectChanges();\n\n    return cmpRef;\n  }\n\n\n  private onEnd(event: TransitionEvent | AnimationEvent): void {\n\n    if (!this.animationEnd.closed) {\n      this.animationEnd.next(event);\n    }\n  }\n\n}\n","import {\n  Directive,\n  Input,\n  ElementRef,\n  ViewContainerRef,\n  OnDestroy\n} from '@angular/core';\n\nimport { DialogRef } from '../models/dialog-ref';\nimport { vcRefStore } from '../models/vc-ref-store';\nimport { Overlay } from \"./overlay.service\";\n\n/**\n * A directive use to signal the overlay that the host of this directive\n * is a dialog boundary, i.e: over click outside of the element should close the modal\n * (if non blocking)\n */\n@Directive({\n  selector: '[overlayDialogBoundary]'\n})\nexport class OverlayDialogBoundary {\n  constructor(el: ElementRef, dialogRef: DialogRef<any>) {\n    if (dialogRef && el.nativeElement) {\n      dialogRef.overlayRef.instance.setClickBoundary(el.nativeElement);\n    }\n  }\n\n}\n\n@Directive({\n  selector: '[overlayTarget]'\n})\nexport class OverlayTarget implements OnDestroy {\n  @Input('overlayTarget') set targetKey(value: string) {\n    this._targetKey = value;\n    if (value) {\n      vcRefStore.setVCRef(value, this.vcRef);\n    }\n  }\n\n  private _targetKey: string;\n\n  constructor(private vcRef: ViewContainerRef) {}\n\n  ngOnDestroy() {\n    if (this._targetKey) {\n      vcRefStore.delVCRef(this._targetKey, this.vcRef);\n    }\n  }\n}\n","import { ViewContainerRef } from '@angular/core';\n\nconst vcRefCollection: { [key: string]: ViewContainerRef[] } = {};\n\n\nfunction getVCRef(key: string): ViewContainerRef[] {\n  return vcRefCollection[key] ? vcRefCollection[key].slice() : [];\n}\n\nfunction setVCRef(key: string, vcRef: ViewContainerRef): void {\n  if (!vcRefCollection.hasOwnProperty(key)) {\n    vcRefCollection[key] = [];\n  }\n  vcRefCollection[key].push(vcRef);\n}\n\nfunction delVCRef(key: string, vcRef?: ViewContainerRef): void {\n    if (!vcRef) {\n      vcRefCollection[key] = [];\n    } else {\n      const coll = vcRefCollection[key] || [],\n            idx = coll.indexOf(vcRef);\n      if (idx > -1) {\n        coll.splice(idx, 1);\n      }\n    }\n}\n\n/**\n * A Simple store that holds a reference to ViewContainerRef instances by a user defined key.\n * This, with the OverlayTarget directive makes it easy to block the overlay inside an element\n * without having to use the angular query boilerplate.\n */\nexport const vcRefStore = { getVCRef, setVCRef, delVCRef };\n","import {\n  ComponentRef,\n  Injector,\n  ViewContainerRef,\n  TemplateRef,\n  Type\n} from '@angular/core';\n\nimport { ModalOverlay } from '../overlay/index';\nimport { DialogRef } from './dialog-ref';\nimport { OverlayContext } from '../models/overlay-context';\n\nexport enum DROP_IN_TYPE {\n  alert,\n  prompt,\n  confirm\n}\n\nexport type WideVCRef = ViewContainerRef | string;\n\nexport type ContainerContent = string | TemplateRef<any> | Type<any>;\n\nexport interface OverlayPlugin extends Function {\n  <T>(component: any, dialogRef: DialogRef<T>, config: OverlayConfig): DialogRef<any>;\n}\n\nexport interface OverlayConfig {\n  /**\n   * The context for the modal, attached to the dialog instance, DialogRef.context.\n   * Default: {}\n   */\n  context?: OverlayContext;\n\n  injector?: Injector;\n\n  /**\n   * The element to block using the modal.\n   */\n  viewContainer?: WideVCRef;\n\n  renderer?: OverlayRenderer;\n\n  /**\n   * Not used yet.\n   */\n  overlayPlugins?: OverlayPlugin | Array<OverlayPlugin>;\n}\n\nexport interface ModalComponent<T> {\n  dialog: DialogRef<T>;\n}\n\nexport interface CloseGuard {\n  /**\n   * Invoked before a modal is dismissed.\n   */\n  beforeDismiss?(): boolean | Promise<boolean>;\n\n  /**\n   * Invoked before a modal is closed.\n   */\n  beforeClose?(): boolean | Promise<boolean>;\n}\n\nexport abstract class OverlayRenderer {\n  public abstract render(dialogRef: DialogRef<any>,\n                         vcRef: ViewContainerRef,\n                         injector?: Injector): ComponentRef<ModalOverlay>;\n}\n","import { ComponentRef } from '@angular/core';\nimport { Observable } from 'rxjs/Observable';\nimport { Subject } from 'rxjs/Subject';\n\nimport { PromiseCompleter } from '../framework/utils';\nimport { Overlay, ModalOverlay } from '../overlay/index';\nimport { CloseGuard } from '../models/tokens';\nimport { DialogBailOutError } from '../models/errors';\n\n/**\n * API to an open modal window.\n */\nexport class DialogRef<T> {\n  /**\n   * Reference to the overlay component ref.\n   */\n  overlayRef: ComponentRef<ModalOverlay>;\n\n  /**\n   * States if the modal is inside a specific element.\n   */\n  public inElement: boolean;\n\n  public destroyed: boolean;\n\n  /**\n   * Fired before dialog is destroyed.\n   * No need to unsubscribe, done automatically.\n   * Note: Always called.\n   * When called, overlayRef might or might not be destroyed.\n   */\n  public onDestroy: Observable<void>;\n\n  private _resultDeferred: PromiseCompleter<any> = new PromiseCompleter<any>();\n  private _onDestroy: Subject<void> = new Subject<void>();\n  private closeGuard: CloseGuard;\n\n  constructor(public overlay: Overlay, public context?: T) {\n    this.onDestroy = this._onDestroy.asObservable();\n  }\n\n  /**\n   * A Promise that is resolved on a close event and rejected on a dismiss event.\n   */\n  get result(): Promise<any> {\n    return this._resultDeferred.promise;\n  }\n\n  /**\n   * Set a close/dismiss guard\n   * @param g\n   */\n  setCloseGuard(guard: CloseGuard): void {\n    this.closeGuard = guard;\n  }\n\n  /**\n   *  Close the modal with a return value, i.e: result.\n   */\n  close(result: any = null) {\n    const _close = () => {\n      this.destroy();\n      this._resultDeferred.resolve(result);\n    };\n    this._fireHook<boolean>('beforeClose')\n      .then(value => value !== true && _close())\n      .catch(_close);\n  }\n\n  /**\n   *  Close the modal without a return value, i.e: cancelled.\n   *  This call is automatically invoked when a user either:\n   *  - Presses an exit keyboard key (if configured).\n   *  - Clicks outside of the modal window (if configured).\n   *  Usually, dismiss represent a Cancel button or a X button.\n   */\n  dismiss() {\n    const _dismiss = () => {\n      this.destroy();\n      this._resultDeferred.promise.catch(() => {});\n      this._resultDeferred.reject();\n    };\n    this._fireHook<boolean>('beforeDismiss')\n      .then(value => value !== true && _dismiss())\n      .catch(_dismiss);\n  }\n\n  /**\n   * Gracefully close the overlay/dialog with a rejected result.\n   * Does not trigger canDestroy on the overlay.\n   */\n  bailOut() {\n    if (this.destroyed !== true) {\n      this.destroyed = true;\n      this._onDestroy.next(null);\n      this._onDestroy.complete();\n      this._resultDeferred.reject(new DialogBailOutError());\n    }\n  }\n\n  destroy() {\n    if (this.destroyed !== true) {\n      this.destroyed = true;\n\n      if (typeof this.overlayRef.instance.canDestroy === 'function') {\n        this.overlayRef.instance.canDestroy()\n          .catch( () => {})\n          .then ( () => this._destroy() );\n      } else {\n        this._destroy();\n      }\n    }\n  }\n\n  private _destroy(): void {\n    this._onDestroy.next(null);\n    this._onDestroy.complete();\n    this.overlayRef.destroy()\n  }\n\n  private _fireHook<T>(name: 'beforeClose' | 'beforeDismiss'): Promise<T> {\n    const gurad = this.closeGuard,\n          fn: Function = gurad && typeof gurad[name] === 'function' && gurad[name];\n\n    return Promise.resolve(fn ? fn.call(gurad) : false);\n  }\n}\n","export class DialogBailOutError extends Error {\n  constructor(value?: string) {\n    super();\n\n    if (!value) {\n      value = 'Dialog was forced to close by an unknown source.';\n    }\n    this.message = value;\n  }\n}\n","import {\n  ComponentRef,\n  ComponentFactory,\n  ComponentFactoryResolver,\n  Injector,\n  ViewContainerRef\n} from '@angular/core';\n\nexport interface CreateComponentArgs {\n  component: any;\n  vcRef: ViewContainerRef;\n  injector?: Injector;\n  projectableNodes?: any[][];\n}\n\nexport function createComponent(instructions: CreateComponentArgs): ComponentRef<any> {\n  const injector: Injector =  instructions.injector || instructions.vcRef.parentInjector;\n  const cmpFactory: ComponentFactory<any>\n    = injector.get(ComponentFactoryResolver).resolveComponentFactory(instructions.component);\n\n  if (instructions.vcRef) {\n    return instructions.vcRef.createComponent(\n      cmpFactory,\n      instructions.vcRef.length,\n      injector,\n      instructions.projectableNodes\n    );\n  } else {\n    return cmpFactory.create(injector);\n  }\n}\n\n","/**\n * Simple object extend\n * @param m1\n * @param m2\n */\nexport function extend<T>(m1: any, m2: any): T {\n  var m: T = <T>{};\n  for (var attr in m1) {\n    if (m1.hasOwnProperty(attr)) {\n      (<any>m)[attr] = (<any>m1)[attr];\n    }\n  }\n\n  for (var attr in m2) {\n    if (m2.hasOwnProperty(attr)) {\n      (<any>m)[attr] = (<any>m2)[attr];\n    }\n  }\n\n  return m;\n}\n\n/**\n * Simple, not optimized, array union of unique values.\n * @param arr1\n * @param arr2\n */\nexport function arrayUnion<T>(arr1: any[], arr2: any[]): T[] {\n  return arr1\n    .concat(arr2.filter(v => arr1.indexOf(v) === -1));\n\n}\n\n/**\n * Returns true if the config supports a given key.\n * @param key\n */\nexport function supportsKey(keyCode: number, config: Array<number>): boolean {\n  if (!Array.isArray(config)) return config === null ? false : true;\n  return config.indexOf(keyCode) > -1;\n}\n\n/**\n * Given an object representing a key/value map of css properties, returns a valid css string\n * representing the object.\n * Example:\n * console.log(toStyleString({\n *     position: 'absolute',\n *     width: '100%',\n *     height: '100%',\n *     top: '0',\n *     left: '0',\n *     right: '0',\n *     bottom: '0'\n * }));\n * // position:absolute;width:100%;height:100%;top:0;left:0;right:0;bottom:0\n * @param obj\n */\nexport function toStyleString(obj: any | CSSStyleDeclaration): string {\n  return Object.getOwnPropertyNames(obj)\n    .map(k => `${k}:${obj[k]}`)\n    .join(';');\n\n  // let objStr = JSON.stringify(obj);\n  // return objStr.substr(1, objStr.length - 2)\n  //     .replace(/,/g, ';')\n  //     .replace(/\"/g, '');\n}\n\nexport class PromiseCompleter<R> {\n  promise: Promise<R>;\n  resolve: (value?: R|PromiseLike<R>) => void;\n  reject: (error?: any, stackTrace?: string) => void;\n\n  constructor() {\n    this.promise = new Promise((res, rej) => {\n      this.resolve = res;\n      this.reject = rej;\n    });\n  }\n}\n\nexport interface Class<T> {\n  new(...args: any[]): T;\n}\n\nexport function noop() { }\n","import { extend, arrayUnion } from './utils';\nconst PRIVATE_PREFIX = '$$';\nconst RESERVED_REGEX = /^(\\$\\$).*/;\n\nfunction validateMethodName(name: string) {\n  if (!name) {\n    throw new Error(`Illegal method name. Empty method name is not allowed`);\n  } else if (name in this) {\n    throw new Error(`A member name '${name}' already defined.`);\n  }\n}\n\n/**\n * Returns a list of assigned property names (non private)\n * @param subject\n */\nfunction getAssignedPropertyNames(subject: any): string[] {\n  return Object.getOwnPropertyNames(subject)\n    .filter(name => RESERVED_REGEX.test(name))\n    .map(name => name.substr(2));\n}\n\nexport function privateKey(name: string): string {\n  return PRIVATE_PREFIX + name;\n}\n\nfunction objectDefinePropertyValue(obj: any, propertyName, value: (value: any) => void): void {\n  Object.defineProperty(obj, propertyName, <any>{\n    configurable: false,\n    enumerable: false,\n    writable: false,\n    value\n  });\n}\n\n/**\n * Given a FluentAssign instance, apply all of the supplied default values so calling\n * instance.toJSON will return those values (does not create a setter function)\n * @param instance\n * @param defaultValues\n */\nfunction applyDefaultValues(instance: any, defaultValues: Object): void {\n  Object.getOwnPropertyNames(defaultValues)\n    .forEach(name => (<any>instance)[privateKey(name)] = (<any>defaultValues)[name]);\n}\n\n/**\n * Create a function for setting a value for a property on a given object.\n * @param obj The object to apply the key & setter on.\n * @param propertyName The name of the property on the object\n * @param writeOnce If true will allow writing once (default: false)\n *\n * Example:\n * let obj = new FluentAssign<any>;\n * setAssignMethod(obj, 'myProp');\n * obj.myProp('someValue');\n * const result = obj.toJSON();\n * console.log(result); //{ myProp: 'someValue' }\n *\n *\n * let obj = new FluentAssign<any>;\n * setAssignMethod(obj, 'myProp', true); // applying writeOnce\n * obj.myProp('someValue');\n * obj.myProp('someValue'); // ERROR: Overriding config property 'myProp' is not allowed.\n */\nexport function setAssignMethod<T>(obj: T, propertyName: string, writeOnce: boolean = false): void {\n  validateMethodName.call(obj, propertyName);\n\n  const key = privateKey(propertyName);\n  objectDefinePropertyValue(obj, propertyName, (value: any) => {\n    if (writeOnce && this.hasOwnProperty(key)) {\n      throw new Error(`Overriding config property '${propertyName}' is not allowed.`);\n    }\n    obj[key] = value;\n    return obj;\n  });\n}\n\n/**\n * Create a function for setting a value that is an alias to an other setter function.\n * @param obj The object to apply the key & setter on.\n * @param propertyName The name of the property on the object\n * @param srcPropertyName The name of the property on the object this alias points to\n * @param hard If true, will set a readonly property on the object that returns\n *        the value of the source property. Default: false\n *\n * Example:\n * let obj = new FluentAssign<any> ;\n * setAssignMethod(obj, 'myProp');\n * setAssignAlias(obj, 'myPropAlias', 'myProp');\n * obj.myPropAlias('someValue');\n * const result = obj.toJSON();\n * console.log(result); //{ myProp: 'someValue' }\n * result.myPropAlias // undefined\n *\n *\n * let obj = new FluentAssign<any> ;\n * setAssignMethod(obj, 'myProp');\n * setAssignAlias(obj, 'myPropAlias', 'myProp', true); // setting a hard alias.\n * obj.myPropAlias('someValue');\n * const result = obj.toJSON();\n * console.log(result); //{ myProp: 'someValue' }\n * result.myPropAlias // someValue\n */\nexport function setAssignAlias<T>(obj: T, propertyName: string,\n                                  srcPropertyName: string,\n                                  hard: boolean = false): void {\n  validateMethodName.call(obj, propertyName);\n\n  objectDefinePropertyValue(obj, propertyName, (value: any) => {\n    obj[srcPropertyName](value);\n    return obj;\n  });\n\n  if (hard === true) {\n    const key = privateKey(propertyName),\n      srcKey = privateKey(srcPropertyName);\n\n    Object.defineProperty(obj, key, <any>{\n      configurable: false,\n      enumerable: false,\n      get: () => obj[srcKey]\n    });\n  }\n}\n\n/**\n * Describes a fluent assign method.\n * A function that gets a value and returns the instance it works on.\n */\nexport interface FluentAssignMethod<T, Z> {\n  //TODO: Setting 'this' instead of Z does not work, this=ConfigSetter here...\n  (value: T): Z;\n}\n\n\nexport interface IFluentAssignFactory<Z> {\n  fluentAssign: Z;\n  setMethod(name: string, defaultValue?: any): IFluentAssignFactory<Z>;\n}\n\n/**\n * Represent a fluent API factory wrapper for defining FluentAssign instances.\n */\nexport class FluentAssignFactory<T> {\n  private _fluentAssign: FluentAssign<T>;\n\n  constructor(fluentAssign?: FluentAssign<T>) {\n    this._fluentAssign =\n      fluentAssign instanceof FluentAssign ? fluentAssign : <any>new FluentAssign();\n  }\n\n  /**\n   * Create a setter method on the FluentAssign instance.\n   * @param name The name of the setter function.\n   * @param defaultValue If set (not undefined) set's the value on the instance immediately.\n   */\n  setMethod(name: string, defaultValue: any = undefined): FluentAssignFactory<T> {\n    setAssignMethod(this._fluentAssign, name);\n    if (defaultValue !== undefined) {\n      (<any>this._fluentAssign)[name](defaultValue);\n    }\n    return this;\n  }\n\n  /**\n   * The FluentAssign instance.\n   */\n  get fluentAssign(): FluentAssign<T> {\n    return this._fluentAssign;\n  }\n}\n\n\n/**\n * Represent an object where every property is a function representing an assignment function.\n * Calling each function with a value will assign the value to the object and return the object.\n * Calling 'toJSON' returns an object with the same properties but this time representing the\n * assigned values.\n *\n * This allows setting an object in a fluent API manner.\n * Example:\n let fluent = new FluentAssign<any>(undefined, ['some', 'went']);\n fluent.some('thing').went('wrong').toJSON();\n // { some: 'thing', went: 'wrong' }\n */\nexport class FluentAssign<T> {\n  private __fluent$base__: new () => T;\n\n  /**\n   * Returns a FluentAssignFactory<FluentAssign<T>> ready to define a FluentAssign type.\n   * @param defaultValues An object representing default values for the instance.\n   * @param initialSetters A list of initial setters for the instance.\n   */\n  static compose<T>(defaultValues: T = undefined,\n                    initialSetters: string[] = undefined): FluentAssignFactory<T> {\n\n    return <any>FluentAssign.composeWith<FluentAssign<T>>(\n      new FluentAssign<T>(defaultValues, initialSetters));\n  }\n\n  /**\n   * Returns a FluentAssignFactory<Z> where Z is an instance of FluentAssign<?> or a derived\n   * class of it.\n   * @param fluentAssign An instance of FluentAssign<?> or a derived class of FluentAssign<?>.\n   */\n  static composeWith<Z>(fluentAssign: Z): IFluentAssignFactory<Z> {\n    return <any>new FluentAssignFactory<any>(<any>fluentAssign);\n  }\n\n  /**\n   *\n   * @param defaultValues An object representing default values for the underlying object.\n   * @param initialSetters A list of initial setters for this FluentAssign.\n   * @param baseType the class/type to create a new base. optional, {} is used if not supplied.\n   */\n  constructor(defaultValues: T | T[] = undefined,\n              initialSetters: string[] = undefined,\n              baseType: new () => T = undefined) {\n    if (Array.isArray(defaultValues)) {\n      (defaultValues as Array<any>).forEach(d => applyDefaultValues(this, d));\n    } else if (defaultValues) {\n      applyDefaultValues(this, defaultValues);\n    }\n\n    if (Array.isArray(initialSetters)) {\n\n      initialSetters.forEach(name => setAssignMethod(this, name));\n    }\n\n    if (baseType) {\n      this.__fluent$base__ = baseType;\n    }\n  }\n\n  toJSON(): T {\n    return getAssignedPropertyNames(this)\n      .reduce((obj: T, name: string) => {\n        const key = privateKey(name);\n        // re-define property descriptors (we dont want their value)\n        let propDesc = Object.getOwnPropertyDescriptor(this, key);\n        if (propDesc) {\n          Object.defineProperty(obj, name, propDesc);\n        } else {\n          (<any>obj)[name] = (<any>this)[key];\n        }\n        return obj;\n      }, this.__fluent$base__ ? new this.__fluent$base__() : <any>{});\n  }\n}\n"],"names":["CommonModule","NgModule","ANALYZE_FOR_ENTRY_COMPONENTS","EVENT_MANAGER_PLUGINS","DEFAULT_SETTERS","DEFAULT_VALUES","Injectable","isDoc","Injector","ApplicationRef","ViewChild","ViewContainerRef","ElementRef","Renderer2","ViewEncapsulation","Component","TemplateRef","filter","Subject","Input","Directive","ComponentFactoryResolver"],"mappings":"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"}